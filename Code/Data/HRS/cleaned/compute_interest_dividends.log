-------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/cleaned
> /compute_interest_dividends.log
  log type:  text
 opened on:  21 Aug 2025, 10:50:05

. 
. set more off

. 
. local master "/Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/clea
> ned/hrs_2020_2022_master.dta"

. capture confirm file "`master'"

. if _rc {
.     di as error "ERROR: master file not found -> `master'"
.     exit 198
. }

. 
. use "`master'", clear

. di as txt "Using master file: `master'"
Using master file: /Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/c
> leaned/hrs_2020_2022_master.dta

. 
. * ---------------------------------------------------------------------
. * Helper note:
. * We will create for each frequency variable a multiplier var named <fq>_mult
. * and optionally a label var <fq>_lbl (if decode(value label) exists).
. * We'll create per-asset interest vars named:
. *   int_<asset>_2020, int_<asset>_2021, int_<asset>_2022
. * and totals int_total_YYYY
. * ---------------------------------------------------------------------
. 
. * ---------------------------
. * 2020: pairs (freq, amount)
. * - real estate (other than main home): RQ139 (freq), RQ141 (amt)
. * - private business: RQ153 (freq), RQ155 (amt)
. * - IRA: RQ194 (freq), RQ190 (amt)
. * - stocks: RQ322 (freq), RQ324 (amt)
. * - bonds: RQ336 (freq), RQ338 (amt)
. * - checking/savings: RQ350 (freq), RQ352 (amt)
. * - CDS/t-bills: RQ362 (freq), RQ364 (amt)
. * ---------------------------
. 
. local f2020_re   RQ139

. local a2020_re   RQ141

. 
. local f2020_bus  RQ153

. local a2020_bus  RQ155

. 
. local f2020_ira  RQ194

. local a2020_ira  RQ190

. 
. local f2020_stk  RQ322

. local a2020_stk  RQ324

. 
. local f2020_bnd  RQ336

. local a2020_bnd  RQ338

. 
. local f2020_cash RQ350

. local a2020_cash RQ352

. 
. local f2020_cds  RQ362

. local a2020_cds  RQ364

. 
. * ---------------------------
. * 2021: LCY (annual amounts assumed)
. * - real estate: SQ143
. * - private business: SQ157
. * - IRA: (no LCY variable)
. * - stocks: SQ326
. * - bonds: SQ340
. * - checking/savings: SQ354
. * - CDS/t-bills: SQ366
. * ---------------------------
. 
. local a2021_re  SQ143

. local a2021_bus SQ157

. local a2021_ira ""         // none specified

. local a2021_stk SQ326

. local a2021_bnd SQ340

. local a2021_cash SQ354

. local a2021_cds SQ366

. 
. * ---------------------------
. * 2022: pairs (freq, amount)
. * - real estate: SQ139 (freq), SQ141 (amt)
. * - private business: SQ153 (freq), SQ155 (amt)
. * - IRA: SQ194 (freq), SQ190 (amt)
. * - stocks: SQ322 (freq), SQ324 (amt)
. * - bonds: SQ336 (freq), SQ338 (amt)
. * - checking/savings: SQ350 (freq), SQ352 (amt)
. * - CDS/t-bills: SQ362 (freq), SQ364 (amt)
. * ---------------------------
. 
. local f2022_re   SQ139

. local a2022_re   SQ141

. 
. local f2022_bus  SQ153

. local a2022_bus  SQ155

. 
. local f2022_ira  SQ194

. local a2022_ira  SQ190

. 
. local f2022_stk  SQ322

. local a2022_stk  SQ324

. 
. local f2022_bnd  SQ336

. local a2022_bnd  SQ338

. 
. local f2022_cash SQ350

. local a2022_cash SQ352

. 
. local f2022_cds  SQ362

. local a2022_cds  SQ364

. 
. * ---------------------------------------------------------------------
. * Recode frequency codes 7,8,9 -> missing ONLY for the frequency variables
. * This leaves the original variables present but removes codes 7/8/9
. * from being treated as valid multipliers later. Do not change other vars.
. * ---------------------------------------------------------------------
. local freqvars "`f2020_re' `f2020_bus' `f2020_ira' `f2020_stk' `f2020_bnd' `f2020_c
> ash' `f2020_cds' `f2022_re' `f2022_bus' `f2022_ira' `f2022_stk' `f2022_bnd' `f2022_
> cash' `f2022_cds'"

. 
. di as txt "Recoding frequency codes 7/8/9 -> missing for frequency variables (only)
> ."
Recoding frequency codes 7/8/9 -> missing for frequency variables (only).

. foreach v of local freqvars {
  2.     capture confirm variable `v'
  3.     if _rc {
  4.         di as txt "  Variable `v' not found in dataset -- skipping"
  5.     }
  6.     else {
  7.         capture confirm numeric variable `v'
  8.         if _rc {
  9.             di as txt "  Variable `v' is not numeric -- skipping recode (check t
> ype)."
 10.         }
 11.         else {
 12.             quietly count if inlist(`v',7,8,9)
 13.             di as txt "  `v' records with codes 7/8/9 before recode = " r(N)
 14.             quietly replace `v' = . if inlist(`v',7,8,9)
 15.             quietly count if inlist(`v',7,8,9)
 16.             di as txt "  `v' records with codes 7/8/9 after recode  = " r(N)
 17.         }
 18.     }
 19. }
  RQ139 records with codes 7/8/9 before recode = 13
  RQ139 records with codes 7/8/9 after recode  = 0
  RQ153 records with codes 7/8/9 before recode = 76
  RQ153 records with codes 7/8/9 after recode  = 0
  RQ194 records with codes 7/8/9 before recode = 0
  RQ194 records with codes 7/8/9 after recode  = 0
  RQ322 records with codes 7/8/9 before recode = 213
  RQ322 records with codes 7/8/9 after recode  = 0
  RQ336 records with codes 7/8/9 before recode = 49
  RQ336 records with codes 7/8/9 after recode  = 0
  RQ350 records with codes 7/8/9 before recode = 338
  RQ350 records with codes 7/8/9 after recode  = 0
  RQ362 records with codes 7/8/9 before recode = 118
  RQ362 records with codes 7/8/9 after recode  = 0
  SQ139 records with codes 7/8/9 before recode = 16
  SQ139 records with codes 7/8/9 after recode  = 0
  SQ153 records with codes 7/8/9 before recode = 89
  SQ153 records with codes 7/8/9 after recode  = 0
  SQ194 records with codes 7/8/9 before recode = 3
  SQ194 records with codes 7/8/9 after recode  = 0
  SQ322 records with codes 7/8/9 before recode = 222
  SQ322 records with codes 7/8/9 after recode  = 0
  SQ336 records with codes 7/8/9 before recode = 45
  SQ336 records with codes 7/8/9 after recode  = 0
  SQ350 records with codes 7/8/9 before recode = 326
  SQ350 records with codes 7/8/9 after recode  = 0
  SQ362 records with codes 7/8/9 before recode = 116
  SQ362 records with codes 7/8/9 after recode  = 0

. 
. * ---------------------------------------------------------------------
. * Replace previous map_freq_to_mult with this version (maps numeric codes)
. * Uses survey code mapping (1..9) per your label excerpts:
. *   1 WEEKLY    -> 52
. *   2 2x/month -> 24
. *   3 MONTHLY   -> 12
. *   4 QUARTERLY -> 4
. *   5 EVERY 6 MONTHS -> 2
. *   6 YEARLY    -> 1
. *   7 OTHER / 8 DK / 9 RF / blank -> left as missing in *_mult (we recoded original
>  freqs to . for 7/8/9 above)
. * ---------------------------------------------------------------------
. program define map_freq_to_mult, rclass
  1.     syntax varname
  2.     local fq = "`varlist'"
  3. 
.     // drop any previously created helpers to avoid collisions
.     capture drop `fq'_lbl
  4.     capture drop `fq'_mult
  5. 
.     // create a decoded label string variable if a value label is attached
.     local labname : value label `fq'
  6.     if "`labname'" != "" {
  7.         decode `fq', gen(`fq'_lbl)
  8.     }
  9. 
.     // create multiplier (double) and map by numeric code (survey coding)
.     gen double `fq'_mult = .
 10.     quietly replace `fq'_mult = 52 if `fq' == 1    // WEEKLY
 11.     quietly replace `fq'_mult = 24 if `fq' == 2    // 2 times per month
 12.     quietly replace `fq'_mult = 12 if `fq' == 3    // MONTHLY
 13.     quietly replace `fq'_mult = 4  if `fq' == 4    // QUARTERLY
 14.     quietly replace `fq'_mult = 2  if `fq' == 5    // EVERY 6 MONTHS
 15.     quietly replace `fq'_mult = 1  if `fq' == 6    // YEARLY
 16.     // 7/8/9 were recoded to . above; any remaining 7/8/9 (unlikely) will leave 
> *_mult missing
. 
.     // diagnostics / reporting
.     di as txt "Mapping numeric codes to multipliers for `fq' completed."
 17.     capture confirm variable `fq'_lbl
 18.     if _rc == 0 {
 19.         di as txt "Showing unique value-label text for `fq' (if present):"
 20.         tab `fq'_lbl, nolabel
 21.     }
 22.     else {
 23.         di as txt "No value label attached to `fq' (or decode failed). Showing r
> aw numeric codes:"
 24.         tab `fq', missing
 25.     }
 26.     quietly count if !missing(`fq'_mult)
 27.     di as txt "`fq'_mult nonmissing observations = " r(N)
 28. end

. 
. * ---------------------------
. * Apply mapping to all frequency vars for 2020 and 2022
. * ---------------------------
. 
. di as txt "=== Mapping 2020 frequency variables ==="
=== Mapping 2020 frequency variables ===

. map_freq_to_mult `f2020_re'
(14,276 missing values generated)
Mapping numeric codes to multipliers for RQ139 completed.
No value label attached to RQ139 (or decode failed). Showing raw numeric codes:

     RENTAL |
     INCOME |
RECEIVE HOW |
      OFTEN |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.01        0.01
          2 |          2        0.01        0.02
          3 |        528        3.70        3.72
          4 |          8        0.06        3.78
          5 |          7        0.05        3.82
          6 |         25        0.18        4.00
          . |     13,705       96.00      100.00
------------+-----------------------------------
      Total |     14,276      100.00
RQ139_mult nonmissing observations = 571

. map_freq_to_mult `f2020_bus'
(14,276 missing values generated)
Mapping numeric codes to multipliers for RQ153 completed.
No value label attached to RQ153 (or decode failed). Showing raw numeric codes:

BUSINESS OR |
   FARM INC |
RECEIVE HOW |
      OFTEN |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         43        0.30        0.30
          2 |         23        0.16        0.46
          3 |        129        0.90        1.37
          4 |         16        0.11        1.48
          5 |         36        0.25        1.73
          6 |        146        1.02        2.75
          . |     13,883       97.25      100.00
------------+-----------------------------------
      Total |     14,276      100.00
RQ153_mult nonmissing observations = 393

. map_freq_to_mult `f2020_ira'
(14,276 missing values generated)
Mapping numeric codes to multipliers for RQ194 completed.
No value label attached to RQ194 (or decode failed). Showing raw numeric codes:

   INC FROM |
  OTHER IRA |
 AMOUNT PRE |
  TAX - PER |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |         10        0.07        0.07
          6 |          8        0.06        0.13
          . |     14,258       99.87      100.00
------------+-----------------------------------
      Total |     14,276      100.00
RQ194_mult nonmissing observations = 18

. map_freq_to_mult `f2020_stk'
(14,276 missing values generated)
Mapping numeric codes to multipliers for RQ322 completed.
No value label attached to RQ322 (or decode failed). Showing raw numeric codes:

      STOCK |
 INCOME HOW |
      OFTEN |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        407        2.85        2.85
          3 |        143        1.00        3.85
          4 |        517        3.62        7.47
          5 |         25        0.18        7.65
          6 |         98        0.69        8.34
          . |     13,086       91.66      100.00
------------+-----------------------------------
      Total |     14,276      100.00
RQ322_mult nonmissing observations = 1190

. map_freq_to_mult `f2020_bnd'
(14,276 missing values generated)
Mapping numeric codes to multipliers for RQ336 completed.
No value label attached to RQ336 (or decode failed). Showing raw numeric codes:

BOND INCOME |
  HOW OFTEN |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         69        0.48        0.48
          3 |         45        0.32        0.80
          4 |         42        0.29        1.09
          5 |         22        0.15        1.25
          6 |         21        0.15        1.39
          . |     14,077       98.61      100.00
------------+-----------------------------------
      Total |     14,276      100.00
RQ336_mult nonmissing observations = 199

. map_freq_to_mult `f2020_cash'
(14,276 missing values generated)
Mapping numeric codes to multipliers for RQ350 completed.
No value label attached to RQ350 (or decode failed). Showing raw numeric codes:

   CHECKING |
 INCOME HOW |
      OFTEN |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        294        2.06        2.06
          3 |      1,926       13.49       15.55
          4 |        692        4.85       20.40
          5 |         50        0.35       20.75
          6 |        287        2.01       22.76
          . |     11,027       77.24      100.00
------------+-----------------------------------
      Total |     14,276      100.00
RQ350_mult nonmissing observations = 3249

. map_freq_to_mult `f2020_cds'
(14,276 missing values generated)
Mapping numeric codes to multipliers for RQ362 completed.
No value label attached to RQ362 (or decode failed). Showing raw numeric codes:

 CDS INCOME |
  HOW OFTEN |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        196        1.37        1.37
          3 |        142        0.99        2.37
          4 |        110        0.77        3.14
          5 |         22        0.15        3.29
          6 |        132        0.92        4.22
          . |     13,674       95.78      100.00
------------+-----------------------------------
      Total |     14,276      100.00
RQ362_mult nonmissing observations = 602

. 
. di as txt "=== Mapping 2022 frequency variables ==="
=== Mapping 2022 frequency variables ===

. map_freq_to_mult `f2022_re'
(14,276 missing values generated)
Mapping numeric codes to multipliers for SQ139 completed.
No value label attached to SQ139 (or decode failed). Showing raw numeric codes:

     RENTAL |
     INCOME |
RECEIVE HOW |
      OFTEN |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          5        0.04        0.04
          3 |        519        3.64        3.67
          4 |         10        0.07        3.74
          5 |          6        0.04        3.78
          6 |         36        0.25        4.03
          . |     13,700       95.97      100.00
------------+-----------------------------------
      Total |     14,276      100.00
SQ139_mult nonmissing observations = 576

. map_freq_to_mult `f2022_bus'
(14,276 missing values generated)
Mapping numeric codes to multipliers for SQ153 completed.
No value label attached to SQ153 (or decode failed). Showing raw numeric codes:

BUSINESS OR |
   FARM INC |
RECEIVE HOW |
      OFTEN |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         43        0.30        0.30
          2 |         19        0.13        0.43
          3 |        131        0.92        1.35
          4 |         22        0.15        1.51
          5 |         32        0.22        1.73
          6 |        126        0.88        2.61
          . |     13,903       97.39      100.00
------------+-----------------------------------
      Total |     14,276      100.00
SQ153_mult nonmissing observations = 373

. map_freq_to_mult `f2022_ira'
(14,276 missing values generated)
Mapping numeric codes to multipliers for SQ194 completed.
No value label attached to SQ194 (or decode failed). Showing raw numeric codes:

   INC FROM |
  OTHER IRA |
 AMOUNT PRE |
  TAX - PER |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |         10        0.07        0.07
          6 |          5        0.04        0.11
          . |     14,261       99.89      100.00
------------+-----------------------------------
      Total |     14,276      100.00
SQ194_mult nonmissing observations = 15

. map_freq_to_mult `f2022_stk'
(14,276 missing values generated)
Mapping numeric codes to multipliers for SQ322 completed.
No value label attached to SQ322 (or decode failed). Showing raw numeric codes:

      STOCK |
 INCOME HOW |
      OFTEN |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        332        2.33        2.33
          3 |        154        1.08        3.40
          4 |        521        3.65        7.05
          5 |         21        0.15        7.20
          6 |        114        0.80        8.00
          . |     13,134       92.00      100.00
------------+-----------------------------------
      Total |     14,276      100.00
SQ322_mult nonmissing observations = 1142

. map_freq_to_mult `f2022_bnd'
(14,276 missing values generated)
Mapping numeric codes to multipliers for SQ336 completed.
No value label attached to SQ336 (or decode failed). Showing raw numeric codes:

BOND INCOME |
  HOW OFTEN |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         61        0.43        0.43
          3 |         45        0.32        0.74
          4 |         35        0.25        0.99
          5 |         21        0.15        1.13
          6 |         32        0.22        1.36
          . |     14,082       98.64      100.00
------------+-----------------------------------
      Total |     14,276      100.00
SQ336_mult nonmissing observations = 194

. map_freq_to_mult `f2022_cash'
(14,276 missing values generated)
Mapping numeric codes to multipliers for SQ350 completed.
No value label attached to SQ350 (or decode failed). Showing raw numeric codes:

   CHECKING |
 INCOME HOW |
      OFTEN |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        264        1.85        1.85
          3 |      1,991       13.95       15.80
          4 |        630        4.41       20.21
          5 |         36        0.25       20.46
          6 |        349        2.44       22.91
          . |     11,006       77.09      100.00
------------+-----------------------------------
      Total |     14,276      100.00
SQ350_mult nonmissing observations = 3270

. map_freq_to_mult `f2022_cds'
(14,276 missing values generated)
Mapping numeric codes to multipliers for SQ362 completed.
No value label attached to SQ362 (or decode failed). Showing raw numeric codes:

 CDS INCOME |
  HOW OFTEN |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        121        0.85        0.85
          3 |        128        0.90        1.74
          4 |         96        0.67        2.42
          5 |         33        0.23        2.65
          6 |        135        0.95        3.59
          . |     13,763       96.41      100.00
------------+-----------------------------------
      Total |     14,276      100.00
SQ362_mult nonmissing observations = 513

. 
. * ---------------------------------------------------------------------
. * Compute per-asset interest for 2020 and 2022 when both amount & multiplier exist
. * For 2021 we assume amounts are annual and use them directly.
. * After each computed variable we summarize it.
. * ---------------------------------------------------------------------
. 
. cap drop int_re_2020 int_bus_2020 int_ira_2020 int_stk_2020 int_bnd_2020 int_cash_2
> 020 int_cds_2020

. cap drop int_re_2022 int_bus_2022 int_ira_2022 int_stk_2022 int_bnd_2022 int_cash_2
> 022 int_cds_2022

. cap drop int_re_2021 int_bus_2021 int_ira_2021 int_stk_2021 int_bnd_2021 int_cash_2
> 021 int_cds_2021

. 
. * 2020 computations
. di as txt "=== Computing 2020 interest/dividends per asset ==="
=== Computing 2020 interest/dividends per asset ===

. 
. gen double int_re_2020 = .
(14,276 missing values generated)

. replace int_re_2020 = `a2020_re' * `f2020_re'_mult if !missing(`a2020_re') & !missi
> ng(`f2020_re'_mult)
(535 real changes made)

. di as txt "Real estate (2020) summary:"
Real estate (2020) summary:

. summarize int_re_2020, detail

                         int_re_2020
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%         3600              0
10%         6000              0       Obs                 535
25%        10800              0       Sum of wgt.         535

50%        21600                      Mean           125845.2
                        Largest       Std. dev.      315079.7
75%        48000        1199988
90%       192000        1199988       Variance       9.93e+10
95%      1199976        1199988       Skewness       3.026989
99%      1199988        1199988       Kurtosis       10.41966

. 
. gen double int_bus_2020 = .
(14,276 missing values generated)

. replace int_bus_2020 = `a2020_bus' * `f2020_bus'_mult if !missing(`a2020_bus') & !m
> issing(`f2020_bus'_mult)
(195 real changes made)

. di as txt "Private business (2020) summary:"
Private business (2020) summary:

. summarize int_bus_2020, detail

                        int_bus_2020
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%         2800              0       Obs                 195
25%        12000              0       Sum of wgt.         195

50%        36000                      Mean           91338.95
                        Largest       Std. dev.      249088.6
75%        78000         624000
90%       180000        1200000       Variance       6.20e+10
95%       280000        1300000       Skewness       8.053619
99%      1300000        2832000       Kurtosis       81.08913

. 
. gen double int_ira_2020 = .
(14,276 missing values generated)

. replace int_ira_2020 = `a2020_ira' * `f2020_ira'_mult if !missing(`a2020_ira') & !m
> issing(`f2020_ira'_mult)
(18 real changes made)

. di as txt "IRA (2020) summary:"
IRA (2020) summary:

. summarize int_ira_2020, detail

                        int_ira_2020
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0           3300
10%         3300           4800       Obs                  18
25%         6900           5000       Sum of wgt.          18

50%        12000                      Mean           14102.22
                        Largest       Std. dev.       11328.7
75%        20000          21000
90%        30000          21600       Variance       1.28e+08
95%        48000          30000       Skewness       1.558286
99%        48000          48000       Kurtosis       5.537241

. 
. gen double int_stk_2020 = .
(14,276 missing values generated)

. replace int_stk_2020 = `a2020_stk' * `f2020_stk'_mult if !missing(`a2020_stk') & !m
> issing(`f2020_stk'_mult)
(443 real changes made)

. di as txt "Stocks (2020) summary:"
Stocks (2020) summary:

. summarize int_stk_2020, detail

                        int_stk_2020
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            4              0
10%           24              0       Obs                 443
25%          236              0       Sum of wgt.         443

50%         1800                      Mean           12088.01
                        Largest       Std. dev.      37592.78
75%         8800         220000
90%        24000         240000       Variance       1.41e+09
95%        48000         400000       Skewness       7.645478
99%       199200         451740       Kurtosis       75.63157

. 
. gen double int_bnd_2020 = .
(14,276 missing values generated)

. replace int_bnd_2020 = `a2020_bnd' * `f2020_bnd'_mult if !missing(`a2020_bnd') & !m
> issing(`f2020_bnd'_mult)
(103 real changes made)

. di as txt "Bonds (2020) summary:"
Bonds (2020) summary:

. summarize int_bnd_2020, detail

                        int_bnd_2020
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%          400              0
10%         1836            108       Obs                 103
25%        60000            300       Sum of wgt.         103

50%       399992                      Mean           550368.4
                        Largest       Std. dev.      506526.4
75%      1199976        1199976
90%      1199976        1199976       Variance       2.57e+11
95%      1199976        1199976       Skewness       .3820821
99%      1199976        1199976       Kurtosis       1.379856

. 
. gen double int_cash_2020 = .
(14,276 missing values generated)

. replace int_cash_2020 = `a2020_cash' * `f2020_cash'_mult if !missing(`a2020_cash') 
> & !missing(`f2020_cash'_mult)
(2,586 real changes made)

. di as txt "Checking/savings (2020) summary:"
Checking/savings (2020) summary:

. summarize int_cash_2020, detail

                        int_cash_2020
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            2              0
10%            8              0       Obs               2,586
25%           12              0       Sum of wgt.       2,586

50%          144                      Mean             261041
                        Largest       Std. dev.      463791.7
75%       399992        1199988
90%      1199976        1199988       Variance       2.15e+11
95%      1199976        1199988       Skewness        1.42588
99%      1199988        1199988       Kurtosis       3.211922

. 
. gen double int_cds_2020 = .
(14,276 missing values generated)

. replace int_cds_2020 = `a2020_cds' * `f2020_cds'_mult if !missing(`a2020_cds') & !m
> issing(`f2020_cds'_mult)
(260 real changes made)

. di as txt "CDS/t-bills (2020) summary:"
CDS/t-bills (2020) summary:

. summarize int_cds_2020, detail

                        int_cds_2020
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            4              0
10%           30              0       Obs                 260
25%          328              0       Sum of wgt.         260

50%         3600                      Mean           290548.3
                        Largest       Std. dev.      442646.4
75%       399992        1199988
90%      1199976        1199988       Variance       1.96e+11
95%      1199976        1199988       Skewness       1.346754
99%      1199988        1199988       Kurtosis       3.216114

. 
. * Summed 2020 interest across asset classes
. egen double int_total_2020 = rowtotal(int_re_2020 int_bus_2020 int_ira_2020 int_stk
> _2020 int_bnd_2020 int_cash_2020 int_cds_2020)

. di as txt "TOTAL interest/dividends 2020 summary (sum across asset classes):"
TOTAL interest/dividends 2020 summary (sum across asset classes):

. summarize int_total_2020, detail

                       int_total_2020
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs              14,276
25%            0              0       Sum of wgt.      14,276

50%            0                      Mean           62904.86
                        Largest       Std. dev.        263730
75%            0        2799960
90%        12000        2799972       Variance       6.96e+10
95%       399992        3000000       Skewness       4.896816
99%      1199988        3599964       Kurtosis       29.91433

. tabstat int_total_2020, stats(n mean sd p50 min max) format(%12.2f)

    Variable |            N         Mean           SD          p50          Min
-------------+-----------------------------------------------------------------
int_tot~2020 |     14276.00     62904.86    263730.02         0.00         0.00
-------------------------------------------------------------------------------

    Variable |          Max
-------------+-------------
int_tot~2020 |   3599964.00
---------------------------

. 
. * 2021 computations (assume LCY amounts are annual)
. di as txt "=== Processing 2021 LCY (annual) variables ==="
=== Processing 2021 LCY (annual) variables ===

. capture confirm variable `a2021_re'

. if _rc == 0 {
.     gen double int_re_2021 = `a2021_re'
(14,208 missing values generated)
.     di as txt "Real estate (2021) summary:"
Real estate (2021) summary:
.     summarize int_re_2021, detail

                         int_re_2021
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs                  68
25%         2000              0       Sum of wgt.          68

50%         7230                      Mean           24623.68
                        Largest       Std. dev.      44712.31
75%        27500         100000
90%        60000         150000       Variance       2.00e+09
95%       100000         200000       Skewness       3.257321
99%       250000         250000       Kurtosis        14.5599
. }

. else {
.     gen double int_re_2021 = .
. }

. 
. capture confirm variable `a2021_bus'

. if _rc == 0 {
.     gen double int_bus_2021 = `a2021_bus'
(14,023 missing values generated)
.     di as txt "Private business (2021) summary:"
Private business (2021) summary:
.     summarize int_bus_2021, detail

                        int_bus_2021
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%          300              0
10%         1000              0       Obs                 253
25%         5000              0       Sum of wgt.         253

50%        20000                      Mean           76591.64
                        Largest       Std. dev.      303081.9
75%        50000         700000
90%       200000         750000       Variance       9.19e+10
95%       250000        1100000       Skewness       12.61442
99%       750000        4500000       Kurtosis       181.4758
. }

. else {
.     gen double int_bus_2021 = .
. }

. 
. * IRA 2021: you said there is no LCY var -> keep missing
. gen double int_ira_2021 = .
(14,276 missing values generated)

. 
. capture confirm variable `a2021_stk'

. if _rc == 0 {
.     gen double int_stk_2021 = `a2021_stk'
(13,715 missing values generated)
.     di as txt "Stocks (2021) summary:"
Stocks (2021) summary:
.     summarize int_stk_2021, detail

                        int_stk_2021
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs                 561
25%            0              0       Sum of wgt.         561

50%          717                      Mean           16684.36
                        Largest       Std. dev.      50583.95
75%        12000         350000
90%        42000         380000       Variance       2.56e+09
95%        70000         500000       Skewness       6.790184
99%       300000         600000       Kurtosis         60.838
. }

. else {
.     gen double int_stk_2021 = .
. }

. 
. capture confirm variable `a2021_bnd'

. if _rc == 0 {
.     gen double int_bnd_2021 = `a2021_bnd'
(14,187 missing values generated)
.     di as txt "Bonds (2021) summary:"
Bonds (2021) summary:
.     summarize int_bnd_2021, detail

                        int_bnd_2021
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs                  89
25%            0              0       Sum of wgt.          89

50%            0                      Mean           8316.124
                        Largest       Std. dev.       23168.8
75%         2000          63000
90%        24000          80000       Variance       5.37e+08
95%        60000         100000       Skewness       3.997341
99%       150000         150000       Kurtosis       20.73902
. }

. else {
.     gen double int_bnd_2021 = .
. }

. 
. capture confirm variable `a2021_cash'

. if _rc == 0 {
.     gen double int_cash_2021 = `a2021_cash'
(13,396 missing values generated)
.     di as txt "Checking/savings (2021) summary:"
Checking/savings (2021) summary:
.     summarize int_cash_2021, detail

                        int_cash_2021
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs                 880
25%            1              0       Sum of wgt.         880

50%           15                      Mean           631.4648
                        Largest       Std. dev.      2942.145
75%          129          30000
90%         1000          30000       Variance        8656216
95%         2350          35000       Skewness       8.604112
99%        12000          40000       Kurtosis       90.45864
. }

. else {
.     gen double int_cash_2021 = .
. }

. 
. capture confirm variable `a2021_cds'

. if _rc == 0 {
.     gen double int_cds_2021 = `a2021_cds'
(13,988 missing values generated)
.     di as txt "CDS/t-bills (2021) summary:"
CDS/t-bills (2021) summary:
.     summarize int_cds_2021, detail

                        int_cds_2021
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs                 288
25%            0              0       Sum of wgt.         288

50%            0                      Mean           2464.594
                        Largest       Std. dev.      16919.73
75%          210          50000
90%         2000          50000       Variance       2.86e+08
95%         6000          80000       Skewness       12.98106
99%        50000         260619       Kurtosis       191.7025
. }

. else {
.     gen double int_cds_2021 = .
. }

. 
. egen double int_total_2021 = rowtotal(int_re_2021 int_bus_2021 int_ira_2021 int_stk
> _2021 int_bnd_2021 int_cash_2021 int_cds_2021)

. di as txt "TOTAL interest/dividends 2021 summary (sum across asset classes):"
TOTAL interest/dividends 2021 summary (sum across asset classes):

. summarize int_total_2021, detail

                       int_total_2021
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs              14,276
25%            0              0       Sum of wgt.      14,276

50%            0                      Mean           2270.779
                        Largest       Std. dev.      43526.82
75%            0         700000
90%            0        1000030       Variance       1.89e+09
95%          500        1100000       Skewness       80.57024
99%        50000        4500000       Kurtosis       8048.444

. tabstat int_total_2021, stats(n mean sd p50 min max) format(%12.2f)

    Variable |            N         Mean           SD          p50          Min
-------------+-----------------------------------------------------------------
int_tot~2021 |     14276.00      2270.78     43526.82         0.00         0.00
-------------------------------------------------------------------------------

    Variable |          Max
-------------+-------------
int_tot~2021 |   4500000.00
---------------------------

. 
. * 2022 computations
. di as txt "=== Computing 2022 interest/dividends per asset ==="
=== Computing 2022 interest/dividends per asset ===

. 
. gen double int_re_2022 = .
(14,276 missing values generated)

. replace int_re_2022 = `a2022_re' * `f2022_re'_mult if !missing(`a2022_re') & !missi
> ng(`f2022_re'_mult)
(492 real changes made)

. di as txt "Real estate (2022) summary:"
Real estate (2022) summary:

. summarize int_re_2022, detail

                         int_re_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%         3600              0
10%         6000              0       Obs                 492
25%        10110              0       Sum of wgt.         492

50%        18660                      Mean           40018.46
                        Largest       Std. dev.      74396.15
75%        36000         372000
90%        84000         504000       Variance       5.53e+09
95%       168000         600000       Skewness       6.316775
99%       360000         960000       Kurtosis       61.16649

. 
. gen double int_bus_2022 = .
(14,276 missing values generated)

. replace int_bus_2022 = `a2022_bus' * `f2022_bus'_mult if !missing(`a2022_bus') & !m
> issing(`f2022_bus'_mult)
(211 real changes made)

. di as txt "Private business (2022) summary:"
Private business (2022) summary:

. summarize int_bus_2022, detail

                        int_bus_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%          300              0
10%         2040              0       Obs                 211
25%        15000              0       Sum of wgt.         211

50%        36000                      Mean           81204.21
                        Largest       Std. dev.      135068.6
75%        78000         540000
90%       192000         600000       Variance       1.82e+10
95%       348000         936000       Skewness       3.737966
99%       600000         960000       Kurtosis       20.19363

. 
. gen double int_ira_2022 = .
(14,276 missing values generated)

. replace int_ira_2022 = `a2022_ira' * `f2022_ira'_mult if !missing(`a2022_ira') & !m
> issing(`f2022_ira'_mult)
(15 real changes made)

. di as txt "IRA (2022) summary:"
IRA (2022) summary:

. summarize int_ira_2022, detail

                        int_ira_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%          840            840
 5%          840           2100
10%         2100           5256       Obs                  15
25%         6900           6900       Sum of wgt.          15

50%         8400                      Mean            24362.8
                        Largest       Std. dev.      47836.11
75%        18000          18000
90%        48500          26246       Variance       2.29e+09
95%       192000          48500       Skewness       3.150377
99%       192000         192000       Kurtosis       11.56414

. 
. gen double int_stk_2022 = .
(14,276 missing values generated)

. replace int_stk_2022 = `a2022_stk' * `f2022_stk'_mult if !missing(`a2022_stk') & !m
> issing(`f2022_stk'_mult)
(453 real changes made)

. di as txt "Stocks (2022) summary:"
Stocks (2022) summary:

. summarize int_stk_2022, detail

                        int_stk_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            4              0       Obs                 453
25%          120              0       Sum of wgt.         453

50%         1080                      Mean           15513.62
                        Largest       Std. dev.      74403.68
75%         8000         480000
90%        24000         520000       Variance       5.54e+09
95%        49800         596000       Skewness       11.38977
99%       240000        1200000       Kurtosis       159.1124

. 
. gen double int_bnd_2022 = .
(14,276 missing values generated)

. replace int_bnd_2022 = `a2022_bnd' * `f2022_bnd'_mult if !missing(`a2022_bnd') & !m
> issing(`f2022_bnd'_mult)
(58 real changes made)

. di as txt "Bonds (2022) summary:"
Bonds (2022) summary:

. summarize int_bnd_2022, detail

                        int_bnd_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs                  58
25%          300              0       Sum of wgt.          58

50%         3920                      Mean           24864.28
                        Largest       Std. dev.      83534.46
75%        12000          80000
90%        40000         120000       Variance       6.98e+09
95%       120000         204000       Skewness       5.968566
99%       600000         600000       Kurtosis       40.52969

. 
. gen double int_cash_2022 = .
(14,276 missing values generated)

. replace int_cash_2022 = `a2022_cash' * `f2022_cash'_mult if !missing(`a2022_cash') 
> & !missing(`f2022_cash'_mult)
(1,832 real changes made)

. di as txt "Checking/savings (2022) summary:"
Checking/savings (2022) summary:

. summarize int_cash_2022, detail

                        int_cash_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs               1,832
25%           12              0       Sum of wgt.       1,832

50%           40                      Mean            1757.16
                        Largest       Std. dev.      23194.79
75%          240         144000
90%         1080         240000       Variance       5.38e+08
95%         3200         600000       Skewness       26.37502
99%        21600         720000       Kurtosis       751.2759

. 
. gen double int_cds_2022 = .
(14,276 missing values generated)

. replace int_cds_2022 = `a2022_cds' * `f2022_cds'_mult if !missing(`a2022_cds') & !m
> issing(`f2022_cds'_mult)
(153 real changes made)

. di as txt "CDS/t-bills (2022) summary:"
CDS/t-bills (2022) summary:

. summarize int_cds_2022, detail

                        int_cds_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs                 153
25%           10              0       Sum of wgt.         153

50%          240                      Mean           2402.784
                        Largest       Std. dev.      7957.554
75%         1200          32000
90%         3600          36000       Variance       6.33e+07
95%        12000          40000       Skewness       6.071186
99%        40000          72000       Kurtosis       45.67572

. 
. egen double int_total_2022 = rowtotal(int_re_2022 int_bus_2022 int_ira_2022 int_stk
> _2022 int_bnd_2022 int_cash_2022 int_cds_2022)

. di as txt "TOTAL interest/dividends 2022 summary (sum across asset classes):"
TOTAL interest/dividends 2022 summary (sum across asset classes):

. summarize int_total_2022, detail

                       int_total_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs              14,276
25%            0              0       Sum of wgt.      14,276

50%            0                      Mean           3449.507
                        Largest       Std. dev.      33738.64
75%            0         960000
90%          120         960000       Variance       1.14e+09
95%         7208        1026000       Skewness       24.74988
99%        72120        1800012       Kurtosis       885.5141

. tabstat int_total_2022, stats(n mean sd p50 min max) format(%12.2f)

    Variable |            N         Mean           SD          p50          Min
-------------+-----------------------------------------------------------------
int_tot~2022 |     14276.00      3449.51     33738.64         0.00         0.00
-------------------------------------------------------------------------------

    Variable |          Max
-------------+-------------
int_tot~2022 |   1800012.00
---------------------------

. 
. * ---------------------------------------------------------------------
. * Combined: 3-year sum (simple sum of annual totals)
. * If you later want weighted averaging / annualization, do that separately.
. * ---------------------------------------------------------------------
. egen double int_total_2020_21_22 = rowtotal(int_total_2020 int_total_2021 int_total
> _2022)

. di as txt "TOTAL interest/dividends (2020 + 2021 + 2022) summary:"
TOTAL interest/dividends (2020 + 2021 + 2022) summary:

. summarize int_total_2020_21_22, detail

                    int_total_2020_21_22
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs              14,276
25%            0              0       Sum of wgt.      14,276

50%            0                      Mean           68625.14
                        Largest       Std. dev.      271858.1
75%           72        2799972
90%        40120        3372000       Variance       7.39e+10
95%       400032        3599964       Skewness       5.010666
99%      1201776        4873200       Kurtosis       34.54304

. tabstat int_total_2020_21_22, stats(n mean sd p50 min max) format(%12.2f)

    Variable |            N         Mean           SD          p50          Min
-------------+-----------------------------------------------------------------
int_tota~_22 |     14276.00     68625.14    271858.14         0.00         0.00
-------------------------------------------------------------------------------

    Variable |          Max
-------------+-------------
int_tota~_22 |   4873200.00
---------------------------

. 
. * ---------------------------------------------------------------------
. * Quick diagnostics to find cases where amount exists but multiplier missing
. * (these are places to inspect manually and map freq codes)
. * ---------------------------------------------------------------------
. di as txt "=== Diagnostics: amount present but freq multiplier missing (2020) ==="
=== Diagnostics: amount present but freq multiplier missing (2020) ===

. foreach pair in ///
>     "`f2020_re' `a2020_re' int_re_2020" ///
>     "`f2020_bus' `a2020_bus' int_bus_2020" ///
>     "`f2020_ira' `a2020_ira' int_ira_2020" ///
>     "`f2020_stk' `a2020_stk' int_stk_2020" ///
>     "`f2020_bnd' `a2020_bnd' int_bnd_2020" ///
>     "`f2020_cash' `a2020_cash' int_cash_2020" ///
>     "`f2020_cds' `a2020_cds' int_cds_2020" {
  2.     local fq : word 1 of `pair'
  3.     local amt : word 2 of `pair'
  4.     local intv : word 3 of `pair'
  5.     di as txt "---- `intv' (amount var `amt' ; freq var `fq')"
  6.     quietly tab `fq', missing
  7.     quietly count if !missing(`amt') & missing(`fq'_mult)
  8.     di as txt "Records with amount but missing multiplier = " r(N)
  9. }
---- int_re_2020 (amount var RQ141 ; freq var RQ139)
Records with amount but missing multiplier = 0
---- int_bus_2020 (amount var RQ155 ; freq var RQ153)
Records with amount but missing multiplier = 0
---- int_ira_2020 (amount var RQ190 ; freq var RQ194)
Records with amount but missing multiplier = 36
---- int_stk_2020 (amount var RQ324 ; freq var RQ322)
Records with amount but missing multiplier = 0
---- int_bnd_2020 (amount var RQ338 ; freq var RQ336)
Records with amount but missing multiplier = 0
---- int_cash_2020 (amount var RQ352 ; freq var RQ350)
Records with amount but missing multiplier = 0
---- int_cds_2020 (amount var RQ364 ; freq var RQ362)
Records with amount but missing multiplier = 0

. 
. di as txt "=== Diagnostics: amount present but freq multiplier missing (2022) ==="
=== Diagnostics: amount present but freq multiplier missing (2022) ===

. foreach pair in ///
>     "`f2022_re' `a2022_re' int_re_2022" ///
>     "`f2022_bus' `a2022_bus' int_bus_2022" ///
>     "`f2022_ira' `a2022_ira' int_ira_2022" ///
>     "`f2022_stk' `a2022_stk' int_stk_2022" ///
>     "`f2022_bnd' `a2022_bnd' int_bnd_2022" ///
>     "`f2022_cash' `a2022_cash' int_cash_2022" ///
>     "`f2022_cds' `a2022_cds' int_cds_2022" {
  2.     local fq : word 1 of `pair'
  3.     local amt : word 2 of `pair'
  4.     local intv : word 3 of `pair'
  5.     di as txt "---- `intv' (amount var `amt' ; freq var `fq')"
  6.     quietly tab `fq', missing
  7.     quietly count if !missing(`amt') & missing(`fq'_mult)
  8.     di as txt "Records with amount but missing multiplier = " r(N)
  9. }
---- int_re_2022 (amount var SQ141 ; freq var SQ139)
Records with amount but missing multiplier = 0
---- int_bus_2022 (amount var SQ155 ; freq var SQ153)
Records with amount but missing multiplier = 0
---- int_ira_2022 (amount var SQ190 ; freq var SQ194)
Records with amount but missing multiplier = 51
---- int_stk_2022 (amount var SQ324 ; freq var SQ322)
Records with amount but missing multiplier = 0
---- int_bnd_2022 (amount var SQ338 ; freq var SQ336)
Records with amount but missing multiplier = 0
---- int_cash_2022 (amount var SQ352 ; freq var SQ350)
Records with amount but missing multiplier = 0
---- int_cds_2022 (amount var SQ364 ; freq var SQ362)
Records with amount but missing multiplier = 0

. 
. * ---------------------------------------------------------------------
. * Save dataset with new computed variables
. * ---------------------------------------------------------------------
. local out "/Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/cleaned
> /hrs_2020_2022_with_interest.dta"

. save "`out'", replace
(file /Volumes/SSD
    PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/cleaned/hrs_2020_2022_with_
    > interest.dta not found)
file /Volumes/SSD
    PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/cleaned/hrs_2020_2022_with_
    > interest.dta saved

. di as txt "Saved master with interest/dividend vars to `out'"
Saved master with interest/dividend vars to /Volumes/SSD PRO/Github-forks/Chp2-Belief
> sandTrust/Code/Data/HRS/cleaned/hrs_2020_2022_with_interest.dta

. 
. log close
      name:  <unnamed>
       log:  /Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/cleaned
> /compute_interest_dividends.log
  log type:  text
 closed on:  21 Aug 2025, 10:50:05
-------------------------------------------------------------------------------------
