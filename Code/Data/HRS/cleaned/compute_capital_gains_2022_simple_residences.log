-------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/cleaned
> /compute_capital_gains_2022_simple_residences.log
  log type:  text
 opened on:  22 Aug 2025, 15:05:27

. 
. set more off

. 
. local master "/Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/clea
> ned/hrs_2020_2022_master.dta"

. capture confirm file "`master'"

. if _rc {
.     di as error "ERROR: master file not found -> `master'"
.     exit 198
. }

. use "`master'", clear

. di as txt "Using master file: `master'"
Using master file: /Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/c
> leaned/hrs_2020_2022_master.dta

. 
. * ---------------------------------------------------------------------
. * Variables expected (per your list)
. * Business:    SQ148 (2022), RQ148 (2020), flow: flow_bus_2022
. * Real estate: SQ134 (2022), RQ134 (2020), flow: flow_re_2022
. * Stocks:      SQ317 (2022), RQ317 (2020), flow: flow_stk_2022
. * IRA:         SQ166_1/2/3 (2022), RQ166_1/2/3 (2020), flow: flow_ira_2022
. * Bonds:       SQ331 (2022), RQ331 (2020), no flows
. * Residences:  SH020 + SH162 (2022), RH020 + RH162 (2020), flow: flow_residences_20
> 22
. * ---------------------------------------------------------------------
. 
. di as txt "Checking presence of the main vars..."
Checking presence of the main vars...

. local checkvars "SQ148 RQ148 SQ134 RQ134 SQ317 RQ317 SQ166_1 RQ166_1 SQ166_2 RQ166_
> 2 SQ166_3 RQ166_3 SQ331 RQ331 SH020 RH020 SH162 RH162 flow_bus_2022 flow_re_2022 fl
> ow_stk_2022 flow_ira_2022 flow_residences_2022"

. foreach v of local checkvars {
  2.     capture confirm variable `v'
  3.     if _rc di as warn "  MISSING: `v'" 
  4.     else di as txt "  OK: `v'"
  5. }
  OK: SQ148
  OK: RQ148
  OK: SQ134
  OK: RQ134
  OK: SQ317
  OK: RQ317
  OK: SQ166_1
  OK: RQ166_1
  OK: SQ166_2
  OK: RQ166_2
  OK: SQ166_3
  OK: RQ166_3
  OK: SQ331
  OK: RQ331
  OK: SH020
  OK: RH020
  OK: SH162
  OK: RH162
  OK: flow_bus_2022
  OK: flow_re_2022
  OK: flow_stk_2022
  OK: flow_ira_2022
  OK: flow_residences_2022

. 
. * ---------------------------------------------------------------------
. * Optional: clean sentinel special-missing codes for value vars (adjust if you alre
> ady cleaned)
. * ---------------------------------------------------------------------
. local misscodes 9999998 9999999 -8 -9 999999998 999999999

. local valuevars "SQ148 RQ148 SQ134 RQ134 SQ317 RQ317 SQ166_1 RQ166_1 SQ166_2 RQ166_
> 2 SQ166_3 RQ166_3 SQ331 RQ331 SH020 RH020 SH162 RH162"

. di as txt "Recoding common sentinel codes to missing for value vars (if present)...
> "
Recoding common sentinel codes to missing for value vars (if present)...

. foreach v of local valuevars {
  2.     capture confirm variable `v'
  3.     if _rc continue
  4.     foreach mc of local misscodes {
  5.         quietly replace `v' = . if `v' == `mc'
  6.     }
  7.     di as txt " Summary for `v' (post-recode):"
  8.     summarize `v', detail
  9. }
 Summary for SQ148 (post-recode):

               BUSINESS OR FARM EQUITY AMOUNT
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs                 586
25%        17000              0       Sum of wgt.         586

50%       155000                      Mean           546909.3
                        Largest       Std. dev.       1399356
75%       500000       1.00e+07
90%      1200000       1.00e+07       Variance       1.96e+12
95%      2000000       1.20e+07       Skewness       7.522167
99%      7000000       2.00e+07       Kurtosis       82.13969
 Summary for RQ148 (post-recode):

               BUSINESS OR FARM EQUITY AMOUNT
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs                 572
25%        15000              0       Sum of wgt.         572

50%       127500                      Mean           500951.5
                        Largest       Std. dev.       1277093
75%       460000        7000000
90%      1200000        8000000       Variance       1.63e+12
95%      2000000       1.00e+07       Skewness       8.358759
99%      5000000       2.00e+07       Kurtosis       106.7893
 Summary for SQ134 (post-recode):

                    REAL ESTATE ASSET AMT
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%         5000              0
10%        15000              0       Obs                 898
25%        65000              0       Sum of wgt.         898

50%       200000                      Mean           506814.4
                        Largest       Std. dev.       1207803
75%       500000        9000000
90%      1000000       1.00e+07       Variance       1.46e+12
95%      2000000       1.30e+07       Skewness       7.290112
99%      7000000       1.80e+07       Kurtosis       77.14328
 Summary for RQ134 (post-recode):

                    REAL ESTATE ASSET AMT
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%         6000              0
10%        15000              0       Obs                 865
25%        50000              0       Sum of wgt.         865

50%       150000                      Mean           572288.3
                        Largest       Std. dev.       5157707
75%       350000        7000000
90%       900000        8000000       Variance       2.66e+13
95%      1500000       1.00e+07       Skewness       28.18453
99%      5000000       1.50e+08       Kurtosis       816.3991
 Summary for SQ317 (post-recode):

                     STOCKS TOTAL VALUE
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%          500              0
10%         2600              0       Obs               1,315
25%        20000              0       Sum of wgt.       1,315

50%       100000                      Mean           431699.9
                        Largest       Std. dev.       1120266
75%       400000        8018000
90%      1000000       1.00e+07       Variance       1.25e+12
95%      2000000       1.86e+07       Skewness       9.361708
99%      5000000       2.00e+07       Kurtosis       135.3859
 Summary for RQ317 (post-recode):

                     STOCKS TOTAL VALUE
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0         -20000
 5%         1200              0
10%         3000              0       Obs               1,286
25%        20000              0       Sum of wgt.       1,286

50%       100000                      Mean           382130.5
                        Largest       Std. dev.      904364.3
75%       400000        6300000
90%      1000000        7000000       Variance       8.18e+11
95%      1600000       1.22e+07       Skewness       7.901657
99%      4000000       1.60e+07       Kurtosis        102.758
 Summary for SQ166_1 (post-recode):

                  AMOUNT IN IRA ACCOUNT - 1
-------------------------------------------------------------
      Percentiles      Smallest
 1%          752              0
 5%         5000              0
10%        11000              0       Obs               2,476
25%        40000              0       Sum of wgt.       2,476

50%       117500                      Mean           272728.2
                        Largest       Std. dev.        594785
75%       300000        5000000
90%       698990       1.00e+07       Variance       3.54e+11
95%       973000       1.02e+07       Skewness       13.05875
99%      2000000       1.63e+07       Kurtosis       281.3833
 Summary for RQ166_1 (post-recode):

                  AMOUNT IN IRA ACCOUNT - 1
-------------------------------------------------------------
      Percentiles      Smallest
 1%         1000              0
 5%         4000              0
10%        10000              0       Obs               2,433
25%        33000              0       Sum of wgt.       2,433

50%       100000                      Mean           225127.9
                        Largest       Std. dev.      394835.2
75%       250000        4000000
90%       600000        4200000       Variance       1.56e+11
95%       850000        5500000       Skewness       6.042237
99%      1932945        7000000       Kurtosis        67.6434
 Summary for SQ166_2 (post-recode):

                  AMOUNT IN IRA ACCOUNT - 2
-------------------------------------------------------------
      Percentiles      Smallest
 1%          350              0
 5%         4000              0
10%         8000              0       Obs               1,259
25%        25000              0       Sum of wgt.       1,259

50%        75000                      Mean             150936
                        Largest       Std. dev.      244514.2
75%       183000        1900000
90%       350000        2000000       Variance       5.98e+10
95%       550000        2500000       Skewness        4.98979
99%      1225000        3400000       Kurtosis       43.68342
 Summary for RQ166_2 (post-recode):

                  AMOUNT IN IRA ACCOUNT - 2
-------------------------------------------------------------
      Percentiles      Smallest
 1%          100              0
 5%         3000              0
10%         6000              0       Obs               1,264
25%        20350              0       Sum of wgt.       1,264

50%        60000                      Mean           119514.5
                        Largest       Std. dev.      186303.8
75%       145500        1400000
90%       291000        1755000       Variance       3.47e+10
95%       440000        2000000       Skewness       4.535554
99%       900000        2200000       Kurtosis        34.7467
 Summary for SQ166_3 (post-recode):

                  AMOUNT IN IRA ACCOUNT - 3
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%         3000              0
10%         6064              0       Obs                 523
25%        25000              0       Sum of wgt.         523

50%        68000                      Mean           175351.9
                        Largest       Std. dev.      299222.7
75%       200000        1948534
90%       412000        2000000       Variance       8.95e+10
95%       630000        2200000       Skewness       3.922881
99%      1700000        2500000       Kurtosis       22.61314
 Summary for RQ166_3 (post-recode):

                  AMOUNT IN IRA ACCOUNT - 3
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%         1800              0
10%         5000              0       Obs                 516
25%        20000              0       Sum of wgt.         516

50%        50000                      Mean           131487.9
                        Largest       Std. dev.      213233.5
75%       150000        1390000
90%       365000        1406986       Variance       4.55e+10
95%       550000        1500000       Skewness        3.77734
99%      1000000        2000000       Kurtosis        23.4069
 Summary for SQ331 (post-recode):

                   BOND ASSETS TOTAL VALUE
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%          100              0
10%          700              0       Obs                 210
25%        10000              0       Sum of wgt.         210

50%        71000                      Mean           222551.4
                        Largest       Std. dev.      475363.8
75%       250000        2000000
90%       520500        2000000       Variance       2.26e+11
95%      1000000        3000000       Skewness       5.301784
99%      2000000        4500000       Kurtosis       39.94891
 Summary for RQ331 (post-recode):

                   BOND ASSETS TOTAL VALUE
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%         1000              0
10%         4000              0       Obs                 208
25%        22500              0       Sum of wgt.         208

50%        76500                      Mean           203434.5
                        Largest       Std. dev.      352682.7
75%       210000        1300000
90%       500000        1400000       Variance       1.24e+11
95%       800000        2200000       Skewness       4.113335
99%      1400000        3000000       Kurtosis       26.51187
 Summary for SH020 (post-recode):

                     HOME PRESENT VALUE
-------------------------------------------------------------
      Percentiles      Smallest
 1%        20000              0
 5%        60000              0
10%        90000              0       Obs               6,141
25%       175000              0       Sum of wgt.       6,141

50%       300000                      Mean           408450.1
                        Largest       Std. dev.      437921.8
75%       500000        5500000
90%       800000        6000000       Variance       1.92e+11
95%      1000000        9000000       Skewness       6.168007
99%      2000000       1.00e+07       Kurtosis        86.3059
 Summary for RH020 (post-recode):

                     HOME PRESENT VALUE
-------------------------------------------------------------
      Percentiles      Smallest
 1%        20000              0
 5%        50000              0
10%        80000              0       Obs               6,015
25%       140000              0       Sum of wgt.       6,015

50%       239000                      Mean           987662.9
                        Largest       Std. dev.      4.08e+07
75%       400000        8500000
90%       650000       1.00e+07       Variance       1.66e+15
95%       850000       1.00e+09       Skewness       68.64432
99%      1600000       3.00e+09       Kurtosis       4930.013
 Summary for SH162 (post-recode):

                 PURCHASE PRICE SECOND HOME
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%         5000              0       Obs                 934
25%        15000              0       Sum of wgt.         934

50%        54000                      Mean           133764.1
                        Largest       Std. dev.      287101.4
75%       160000        1300000
90%       334000        1500000       Variance       8.24e+10
95%       495000        1900000       Skewness       12.76591
99%      1000000        6500000       Kurtosis          263.6
 Summary for RH162 (post-recode):

                 PURCHASE PRICE SECOND HOME
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%         2000              0
10%         6000              0       Obs                 977
25%        13500              0       Sum of wgt.         977

50%        50000                      Mean           120430.4
                        Largest       Std. dev.      193620.9
75%       150000        1600000
90%       310000        1800000       Variance       3.75e+10
95%       465000        1800000       Skewness       4.187411
99%       975000        2000000       Kurtosis       29.70291

. 
. * ---------------------------------------------------------------------
. * IRA totals for 2022 and 2020 (sum components)
. * ---------------------------------------------------------------------
. capture drop V_ira_2022 V_ira_2020

. egen double V_ira_2022 = rowtotal(SQ166_1 SQ166_2 SQ166_3)

. egen double V_ira_2020 = rowtotal(RQ166_1 RQ166_2 RQ166_3)

. di as txt "IRA totals (2022 and 2020):"
IRA totals (2022 and 2020):

. summarize V_ira_2022 V_ira_2020, detail

                         V_ira_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs              14,276
25%            0              0       Sum of wgt.      14,276

50%            0                      Mean           67036.46
                        Largest       Std. dev.      344528.9
75%            0        6900000
90%       106000       1.02e+07       Variance       1.19e+11
95%       360000       1.07e+07       Skewness        16.9214
99%      1308095       1.65e+07       Kurtosis       540.0442

                         V_ira_2020
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs              14,276
25%            0              0       Sum of wgt.      14,276

50%            0                      Mean           53702.03
                        Largest       Std. dev.      248200.7
75%            0        4700000
90%        91000        5600000       Variance       6.16e+10
95%       300000        5940000       Skewness       10.59566
99%      1090000        8250000       Kurtosis       190.6546

. quietly count if !missing(V_ira_2022) & !missing(V_ira_2020)

. di as txt "Observations with BOTH IRA V_2022 & V_2020 present = " r(N)
Observations with BOTH IRA V_2022 & V_2020 present = 14276

. 
. * ---------------------------------------------------------------------
. * Combined residence totals (primary + secondary) at 2022 and 2020
. * ---------------------------------------------------------------------
. capture drop V_res_2022 V_res_2020

. egen double V_res_2022 = rowtotal(SH020 SH162)

. egen double V_res_2020 = rowtotal(RH020 RH162)

. di as txt "Residence totals (combined primary + secondary):"
Residence totals (combined primary + secondary):

. summarize V_res_2022 V_res_2020, detail

                         V_res_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs              14,276
25%            0              0       Sum of wgt.      14,276

50%            0                      Mean           184451.4
                        Largest       Std. dev.      379904.3
75%       260000        6000000
90%       530000        9000000       Variance       1.44e+11
95%       800000       1.00e+07       Skewness       7.586369
99%      1600000       1.20e+07       Kurtosis       143.5734

                         V_res_2020
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs              14,276
25%            0              0       Sum of wgt.      14,276

50%            0                      Mean           424380.3
                        Largest       Std. dev.      2.65e+07
75%       200000        8600000
90%       400000       1.00e+07       Variance       7.00e+14
95%       625000       1.00e+09       Skewness       105.7605
99%      1230500       3.00e+09       Kurtosis       11701.68

. quietly count if !missing(V_res_2022) & !missing(V_res_2020)

. di as txt "Observations with BOTH V_res_2022 & V_res_2020 present = " r(N)
Observations with BOTH V_res_2022 & V_res_2020 present = 14276

. 
. * ---------------------------------------------------------------------
. * Helper: a small function to compute cg safely treating missing flow as zero
. * (We compute cg only when both V2022 & V2020 are nonmissing)
. * ---------------------------------------------------------------------
. cap program drop compute_cg

. program define compute_cg, rclass
  1.     syntax varname(varlist) varname(varlist) [varname]
  2.     // compute_cg <v2022> <v2020> [flowvar]
.     local v2022 : word 1 of `varlist'
  3.     local v2020 : word 2 of `varlist'
  4.     local flow  : word 3 of `varlist'
  5.     // target variable name
.     local out = "cg_" + lower("`v2022'") + "_from_" + lower("`v2020'")
  6.     // but we'll pass explicit out names when calling below; this is a fallback
. end

. 
. * ---------------------------------------------------------------------
. * 1) Business: cg_bus_2022 = (SQ148 - RQ148) - flow_bus_2022
. *    Treat missing flow as 0; compute only when both values present
. * ---------------------------------------------------------------------
. capture confirm variable SQ148

. capture confirm variable RQ148

. if (_rc) {
.     di as warn "Business values missing -> cg_bus_2022 set to missing"
.     gen double cg_bus_2022 = .
. }

. else {
.     gen double cg_bus_2022 = .
(14,276 missing values generated)
.     replace cg_bus_2022 = (SQ148 - RQ148) - cond(missing(flow_bus_2022),0,flow_bus_
> 2022) ///
>         if !missing(SQ148) & !missing(RQ148)
(250 real changes made)
.     di as txt "Business cg (cg_bus_2022) summary:"
Business cg (cg_bus_2022) summary:
.     summarize cg_bus_2022, detail

                         cg_bus_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%     -1000000       -1500000
 5%      -400000       -1000000
10%      -200000       -1000000       Obs                 250
25%            0       -1000000       Sum of wgt.         250

50%        10000                      Mean           227090.8
                        Largest       Std. dev.      974249.9
75%       200000        3000000
90%       804000        5000000       Variance       9.49e+11
95%      1300000        7000000       Skewness       6.473899
99%      5000000       1.03e+07       Kurtosis       57.80788
.     quietly count if !missing(cg_bus_2022)
.     di as txt "Records with cg_bus_2022 computed = " r(N)
Records with cg_bus_2022 computed = 250
. }

. 
. * ---------------------------------------------------------------------
. * 2) Real estate (other than main home): cg_re_2022 = (SQ134 - RQ134) - flow_re_202
> 2
. * ---------------------------------------------------------------------
. capture confirm variable SQ134

. capture confirm variable RQ134

. if (_rc) {
.     di as warn "Real estate values missing -> cg_re_2022 set to missing"
.     gen double cg_re_2022 = .
. }

. else {
.     gen double cg_re_2022 = .
(14,276 missing values generated)
.     replace cg_re_2022 = (SQ134 - RQ134) - cond(missing(flow_re_2022),0,flow_re_202
> 2) ///
>         if !missing(SQ134) & !missing(RQ134)
(403 real changes made)
.     di as txt "Real estate cg (cg_re_2022) summary:"
Real estate cg (cg_re_2022) summary:
.     summarize cg_re_2022, detail

                         cg_re_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%     -2200000      -1.47e+08
 5%      -508000       -3400000
10%      -200000       -2600000       Obs                 403
25%        -8000       -2500000       Sum of wgt.         403

50%        40000                      Mean            -179533
                        Largest       Std. dev.       7414867
75%       165000        3310000
90%       650000        5300000       Variance       5.50e+13
95%      1138000        9300000       Skewness      -19.45541
99%      2960000       1.23e+07       Kurtosis       387.0377
.     quietly count if !missing(cg_re_2022)
.     di as txt "Records with cg_re_2022 computed = " r(N)
Records with cg_re_2022 computed = 403
. }

. 
. * ---------------------------------------------------------------------
. * 3) Stocks: cg_stk_2022 = (SQ317 - RQ317) - flow_stk_2022
. * ---------------------------------------------------------------------
. capture confirm variable SQ317

. capture confirm variable RQ317

. if (_rc) {
.     di as warn "Stock value vars missing -> cg_stk_2022 set to missing"
.     gen double cg_stk_2022 = .
. }

. else {
.     gen double cg_stk_2022 = .
(14,276 missing values generated)
.     replace cg_stk_2022 = (SQ317 - RQ317) - cond(missing(flow_stk_2022),0,flow_stk_
> 2022) ///
>         if !missing(SQ317) & !missing(RQ317)
(684 real changes made)
.     di as txt "Stocks cg (cg_stk_2022) summary:"
Stocks cg (cg_stk_2022) summary:
.     summarize cg_stk_2022, detail

                         cg_stk_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%     -1500000       -4100000
 5%      -350000       -2600000
10%      -169000       -2300000       Obs                 684
25%       -15000       -2300000       Sum of wgt.         684

50%         8200                      Mean             115655
                        Largest       Std. dev.        687222
75%       100000        4600000
90%       400000        5000000       Variance       4.72e+11
95%       897996        6424489       Skewness       4.313065
99%      2980000        7553000       Kurtosis       44.27636
.     quietly count if !missing(cg_stk_2022)
.     di as txt "Records with cg_stk_2022 computed = " r(N)
Records with cg_stk_2022 computed = 684
. }

. 
. * ---------------------------------------------------------------------
. * 4) IRA: cg_ira_2022 = (V_ira_2022 - V_ira_2020) - flow_ira_2022
. * ---------------------------------------------------------------------
. gen double cg_ira_2022 = .
(14,276 missing values generated)

. replace cg_ira_2022 = (V_ira_2022 - V_ira_2020) - cond(missing(flow_ira_2022),0,flo
> w_ira_2022) ///
>     if !missing(V_ira_2022) & !missing(V_ira_2020)
(14,276 real changes made)

. di as txt "IRA cg (cg_ira_2022) summary:"
IRA cg (cg_ira_2022) summary:

. summarize cg_ira_2022, detail

                         cg_ira_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%      -480000       -4070000
 5%       -70000       -3450000
10%        -7702       -3000000       Obs              14,276
25%            0       -3000000       Sum of wgt.      14,276

50%            0                      Mean           10293.21
                        Largest       Std. dev.      255165.5
75%            0        4000000
90%        14790        4965000       Variance       6.51e+10
95%       122000       1.01e+07       Skewness       21.98788
99%       700000       1.56e+07       Kurtosis       1190.651

. quietly count if !missing(cg_ira_2022)

. di as txt "Records with cg_ira_2022 computed = " r(N)
Records with cg_ira_2022 computed = 14276

. 
. * ---------------------------------------------------------------------
. * 5) Bonds: cg_bnd_2022 = SQ331 - RQ331  (no flow subtraction)
. * ---------------------------------------------------------------------
. capture confirm variable SQ331

. capture confirm variable RQ331

. if (_rc) {
.     di as warn "Bond value vars missing -> cg_bnd_2022 set to missing"
.     gen double cg_bnd_2022 = .
. }

. else {
.     gen double cg_bnd_2022 = .
(14,276 missing values generated)
.     replace cg_bnd_2022 = (SQ331 - RQ331) if !missing(SQ331) & !missing(RQ331)
(65 real changes made)
.     di as txt "Bonds cg (cg_bnd_2022) summary:"
Bonds cg (cg_bnd_2022) summary:
.     summarize cg_bnd_2022, detail

                         cg_bnd_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%      -700000        -700000
 5%      -255000        -500000
10%      -200000        -305000       Obs                  65
25%       -50000        -255000       Sum of wgt.          65

50%            0                      Mean            -1741.4
                        Largest       Std. dev.      181766.7
75%        50000         283000
90%       205000         321000       Variance       3.30e+10
95%       283000         400000       Skewness       -.604528
99%       500000         500000       Kurtosis       6.476906
.     quietly count if !missing(cg_bnd_2022)
.     di as txt "Records with cg_bnd_2022 computed = " r(N)
Records with cg_bnd_2022 computed = 65
. }

. 
. * ---------------------------------------------------------------------
. * 6) Residences (combined primary + secondary):
. *    cg_res_total_2022 = (V_res_2022 - V_res_2020) - flow_residences_2022
. * ---------------------------------------------------------------------
. gen double cg_res_total_2022 = .
(14,276 missing values generated)

. replace cg_res_total_2022 = (V_res_2022 - V_res_2020) - cond(missing(flow_residence
> s_2022),0,flow_residences_2022) ///
>     if !missing(V_res_2022) & !missing(V_res_2020)
(14,276 real changes made)

. di as txt "Combined residences cg (cg_res_total_2022) summary:"
Combined residences cg (cg_res_total_2022) summary:

. summarize cg_res_total_2022, detail

                      cg_res_total_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%      -800000      -3.00e+09
 5%      -300000      -1.00e+09
10%      -135100      -1.00e+07       Obs              14,276
25%            0       -5600000       Sum of wgt.      14,276

50%            0                      Mean          -239180.3
                        Largest       Std. dev.      2.64e+07
75%        70000        6000000
90%       262000        9000000       Variance       6.99e+14
95%       450000        9090000       Skewness      -105.7325
99%      1000000       1.00e+07       Kurtosis       11696.32

. quietly count if !missing(cg_res_total_2022)

. di as txt "Records with cg_res_total_2022 computed = " r(N)
Records with cg_res_total_2022 computed = 14276

. 
. * ---------------------------------------------------------------------
. * 7) Total capital gains across classes (sum)
. * ---------------------------------------------------------------------
. capture drop cg_total_2022

. egen double cg_total_2022 = rowtotal(cg_bus_2022 cg_re_2022 cg_stk_2022 cg_ira_2022
>  cg_bnd_2022 cg_res_total_2022)

. di as txt "TOTAL capital gains (cg_total_2022) summary (sum across classes):"
TOTAL capital gains (cg_total_2022) summary (sum across classes):

. summarize cg_total_2022, detail

                        cg_total_2022
-------------------------------------------------------------
      Percentiles      Smallest
 1%     -1015000      -3.14e+09
 5%      -360000      -1.00e+09
10%      -180000      -1.00e+07       Obs              14,276
25%            0       -4200000       Sum of wgt.      14,276

50%            0                      Mean            -224445
                        Largest       Std. dev.      2.76e+07
75%        85500       1.15e+07
90%       350000       1.26e+07       Variance       7.63e+14
95%       642000       1.46e+07       Skewness      -106.6481
99%      1700000       1.71e+07       Kurtosis       11881.95

. tabstat cg_total_2022, stats(n mean sd p50 min max) format(%12.2f)

    Variable |            N         Mean           SD          p50          Min
-------------+-----------------------------------------------------------------
cg_tota~2022 |     14276.00   -224444.96  27615355.99         0.00    -3.14e+09
-------------------------------------------------------------------------------

    Variable |          Max
-------------+-------------
cg_tota~2022 |  17114116.00
---------------------------

. 
. * ---------------------------------------------------------------------
. * 8) Diagnostics: inspect top/bottom observations and counts per class
. * ---------------------------------------------------------------------
. di as txt "Top 30 largest positive cg_total_2022 (inspect components):"
Top 30 largest positive cg_total_2022 (inspect components):

. gsort -cg_total_2022

. list HHID RSUBHH cg_total_2022 cg_bus_2022 cg_re_2022 cg_stk_2022 cg_ira_2022 cg_bn
> d_2022 cg_res_total_2022 in 1/30

     +------------------------------------------------------------------------+
  1. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 524071 |      0 | 17114116 |        0 |        . |   115000 | 15553116 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               1446000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  2. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 147589 |      0 | 14639800 |   200000 | 12265000 |  2150000 |  -230200 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                255000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  3. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 034763 |      2 | 12600000 |  2500000 |  9300000 |        . |        0 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                800000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  4. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 500044 |      0 | 11492000 |        . |  2400000 |        . |     2000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               9090000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  5. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 541556 |      0 | 10642000 | 10250000 |        0 |    50000 |    -3000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                345000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  6. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 558128 |      0 | 10060001 |        . |        . |        . |    60000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |              10000001              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  7. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 552818 |      0 |  9750000 |        . |        . |        . |   750000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               9000000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  8. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 076617 |      0 |  9437451 |        . |        . |   -30000 | 10117451 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               -650000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  9. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 118279 |      0 |  8940000 |        . |        . |        . |  3940000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               5000000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 10. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 122692 |      0 |  8165000 |        . |        . |  3000000 |  4965000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                200000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 11. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 500113 |      0 |  8049000 |        . |  5300000 |        . |  1080000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               1669000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 12. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 502452 |      0 |  7806400 |        . |        . |  7553000 |   269400 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                -16000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 13. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 147421 |      0 |  7070000 |  7000000 |        . |        . |        0 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                 70000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 14. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 528714 |      0 |  6625000 |        . |  1000000 |  5000000 |   125000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                500000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 15. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 137440 |      0 |  6574879 |        . |        . |  6424489 |   151454 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                -1064              |                     0              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 16. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 178976 |      1 |  6000000 |        . |        . |        . |        0 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               6000000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 17. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 541495 |      0 |  5584000 |  5000000 |        . |        . |    20000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                564000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 18. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 030423 |      0 |  5120000 |  3000000 |  2000000 |    70000 |        0 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                 50000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 19. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 552965 |      0 |  5025000 |        . |        . |        . |  3725000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               1300000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 20. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 502413 |      0 |  4650000 |        . |        . |        . |  3280000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               1370000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 21. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 545994 |      0 |  4600000 |        . |        . |        . |  4000000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                600000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 22. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 534586 |      0 |  4600000 |        . |        . |        . |  4000000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                600000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 23. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 532216 |      0 |  4452000 |  1400000 |        . |  2700000 |    -3000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |               -45000              |                400000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 24. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 212649 |      0 |  4141000 |        . |        . |  4600000 |  -459000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                     0              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 25. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 540399 |      0 |  4000000 |  1500000 |  2450000 |        . |        0 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                 50000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 26. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 552223 |      0 |  3980000 |        . |        . |        . |   580000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               3400000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 27. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 559300 |      0 |  3950000 |        . |        . |        . |  3300000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |                650000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 28. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 527180 |      0 |  3776893 |        . |        . |        . |  2746893 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               1030000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 29. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 501517 |      1 |  3663000 |    25000 |        . |        . |   335000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               3303000              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 30. |   HHID | RSUBHH | cg_tot~2 | cg_bus~2 | cg_re_~2 | cg_stk~2 | cg_ira~2 |
     | 558160 |      0 |  3641000 |        . |        . |        . |    41000 |
     |------------------------------------------------------------------------|
     |             cg_bnd~2              |              cg_res~2              |
     |                    .              |               3600000              |
     +------------------------------------------------------------------------+

. 
. di as txt "Top 30 largest negative cg_total_2022 (inspect components):"
Top 30 largest negative cg_total_2022 (inspect components):

. gsort cg_total_2022

. list HHID RSUBHH cg_total_2022 cg_bus_2022 cg_re_2022 cg_stk_2022 cg_ira_2022 cg_bn
> d_2022 cg_res_total_2022 in 1/30

     +----------------------------------------------------------------------------+
  1. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 912430 |      0 | -3.144e+09 |        . | -1.474e+08 |        . |   700000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |              -2.997e+09               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
  2. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 909496 |      0 | -1.000e+09 |        . |          . |        . |  -100000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |              -1.000e+09               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
  3. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 540637 |      0 |  -10000000 |        . |          . |        . |        0 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |               -10000000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
  4. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 501770 |      1 |   -4200000 |        . |          . |        . | -3000000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -1200000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
  5. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 112575 |      0 |   -3823000 |        . |    1200000 |   300000 |   277000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -5600000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
  6. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 015893 |      0 |   -3750000 |        . |          . |        . | -3450000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                 -300000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
  7. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 525815 |      0 |   -3525000 |        . |          . |        . | -2000000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -1525000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
  8. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 526133 |      0 |   -3460000 |        . |          . |        . |  -220000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -3240000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
  9. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 076856 |      0 |   -3425000 |        . |          . |        . |        0 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -3425000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 10. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 210974 |      0 |   -3410000 |        . |          . | -1500000 |        0 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -1910000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 11. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 523113 |      0 |   -3405000 |        . |          . |        . |  -800000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -2605000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 12. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 075352 |      0 |   -3400000 |        . |          . |        . |        0 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -3400000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 13. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 137183 |      0 |   -3155000 |        . |          . |        . | -2760000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                 -395000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 14. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 523913 |      0 |   -3090000 |        0 |   -3400000 |        . |    70000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                  240000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 15. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 535945 |      0 |   -3090000 |        . |          . |        . | -1200000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -1890000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 16. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 544811 |      0 |   -3030000 |        . |          . |        . | -1030000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -2000000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 17. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 055720 |      0 |   -3020000 |        . |          . |        . |  -810000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -2210000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 18. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 010929 |      0 |   -3000000 |        . |          . |        . |        0 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -3000000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 19. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 542739 |      0 |   -3000000 |        . |          . |        . |        0 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -3000000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 20. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 083181 |      0 |   -3000000 |        . |          . |        . |        0 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -3000000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 21. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 211577 |      0 |   -2975000 |        . |          . |        . | -3000000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                   25000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 22. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 501053 |      0 |   -2838982 |        . |          . | -4100000 |   951018 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                  310000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 23. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 073406 |      0 |   -2823000 |        . |          . |        . | -2473000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                 -350000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 24. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 031208 |      0 |   -2800000 |        . |          . |        . |        0 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -2800000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 25. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 914149 |      0 |   -2799500 |  -800000 |   -2200000 |      500 |        0 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                  200000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 26. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 544248 |      0 |   -2750000 |        . |          . |        . | -1950000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                 -800000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 27. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 501584 |      0 |   -2500000 |        . |          . |        . |        0 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -2500000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 28. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 502225 |      1 |   -2500000 |        . |          . |        . |        0 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -2500000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 29. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 034126 |      0 |   -2500000 |        . |          . |        . |        0 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                -2500000               |
     +----------------------------------------------------------------------------+

     +----------------------------------------------------------------------------+
 30. |   HHID | RSUBHH | cg_to~2022 | cg_bus~2 | cg_re_2022 | cg_stk~2 | cg_ira~2 |
     | 529474 |      0 |   -2479000 |        . |   -2600000 |        . |  -139000 |
     |----------------------------------------------------------------------------|
     |              cg_bnd~2              |              cg_res_t~2               |
     |                     .              |                  260000               |
     +----------------------------------------------------------------------------+

. 
. foreach v in cg_bus_2022 cg_re_2022 cg_stk_2022 cg_ira_2022 cg_bnd_2022 cg_res_tota
> l_2022 {
  2.     quietly count if !missing(`v')
  3.     di as txt "`v' computed for " r(N) " obs"
  4. }
cg_bus_2022 computed for 250 obs
cg_re_2022 computed for 403 obs
cg_stk_2022 computed for 684 obs
cg_ira_2022 computed for 14276 obs
cg_bnd_2022 computed for 65 obs
cg_res_total_2022 computed for 14276 obs

. 
. * ---------------------------------------------------------------------
. * Save dataset with new capital gains variables BACK TO MASTER (overwrite)
. * ---------------------------------------------------------------------
. save "`master'", replace
file /Volumes/SSD
    PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/cleaned/hrs_2020_2022_maste
    > r.dta saved

. di as txt "Saved capital gains vars back to master: `master'"
Saved capital gains vars back to master: /Volumes/SSD PRO/Github-forks/Chp2-Beliefsan
> dTrust/Code/Data/HRS/cleaned/hrs_2020_2022_master.dta

. 
. log close
      name:  <unnamed>
       log:  /Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/cleaned
> /compute_capital_gains_2022_simple_residences.log
  log type:  text
 closed on:  22 Aug 2025, 15:05:27
-------------------------------------------------------------------------------------
