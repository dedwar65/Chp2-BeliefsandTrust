----------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/cleaned/compute_
> fin_asset_returns.log
  log type:  text
 opened on:  24 Sep 2025, 13:43:39

. 
. set more off

. 
. * ---------------------------------------------------------------------
. * Note: Prerequisite scripts must be run first:
. * - extract_household_2020_ret_calc_end
. * - extract_household_2022_ret_calc_start  
. * - merge_2020_2022
. * - compute_int_inc_div_2020_2022
. * - compute_net_inv_flows_2020_2022
. * - compute_debt_payments_2020_2022
. * - compute_cap_gains_2020_2022
. * - compute_beg_per_net_worth_2020_2022
. * ---------------------------------------------------------------------
. 
. local master "/Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/cleaned/hrs_2
> 020_2022_master.dta"

. capture confirm file "`master'"

. if _rc {
.     di as error "ERROR: master file not found -> `master'"
.     exit 198
. }

. 
. use "`master'", clear

. di as txt "Using master file: `master'"
Using master file: /Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS/cleaned/hr
> s_2020_2022_master.dta

. 
. * ---------------------------------------------------------------------
. * Define financial asset sample
. * Baseline: stocks OR bonds in both years
. * Augmented: OR any numerator signal (any INT_* non-missing OR stock flows non-missing)
. * ---------------------------------------------------------------------
. di as txt "=== Defining financial asset sample ==="
=== Defining financial asset sample ===

. 
. * Check for stocks in both years (SQ317 and RQ317)
. gen byte has_stocks_both = !missing(SQ317) & !missing(RQ317)

. 
. * Check for bonds in both years (SQ331 and RQ331)  
. gen byte has_bonds_both = !missing(SQ331) & !missing(RQ331)

. 
. * Exposure via numerator components present (interest income or stock flows)
. gen byte fin_exposure = (!missing(int_stk_2022) | !missing(int_bnd_2022) | !missing(int_cash
> _2022) | !missing(int_cds_2022) | !missing(flow_stk_2022))
flow_stk_2022 not found
r(111);

end of do-file

r(111);

. do "/Volumes/SSD PRO/Github-forks/Chp2-BeliefsandTrust/Code/Data/HRS_RAND/cleaned/compute_fi
> n_asset_returns.do"

. *----------------------------------------------------------------------
. * RAND: compute_fin_asset_returns.do
. * Compute returns for financial assets (stocks + bonds) for 2022
. * Using lowercase RAND variable names
. * 
. * Formula: r_fin = (yc_fin + cg_fin - F_fin) / (A_2020 + 0.5*F_2022)
. * 
. * Where:
. * - yc_fin = interest income from stocks, bonds, checking/savings, CDs
. * - cg_fin = capital gains from stocks + bonds
. * - F_fin = net investment flows into financial assets (stocks only)
. * - A_2020 = total beginning period net worth
. * - F_2022 = total net investment flows
. *----------------------------------------------------------------------
. clear all

. capture log close
